<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Text Extraction</title>
  <!-- pdfjs-dist for extracting text from PDF files -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
</head>
<body>
  <h1>PDF Text Extraction</h1>

  <!-- Button to trigger text extraction -->
  <button id="extractTextBtn">Extract Text from PDF</button>

  <!-- Text content will be displayed here -->
  <div id="extractedText" style="white-space: pre-wrap; background-color: #f0f0f0; padding: 10px; border: 1px solid #ddd;"></div>

  <script>
    const pdfUrl = 'https://theeuropean417.github.io/TheEuropeanEmployee/handbook-template.pdf';
    const extractedTextDiv = document.getElementById('extractedText');

    // Function to extract and order text based on Y-coordinates
    async function extractTextFromPDF() {
      try {
        // Load the PDF document from the given URL
        const loadingTask = pdfjsLib.getDocument(pdfUrl);
        const pdf = await loadingTask.promise;

        let extractedText = '';

        // Loop through each page in the PDF
        for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
          const page = await pdf.getPage(pageNum);
          const textContent = await page.getTextContent();

          // Collect all items in an array with their Y coordinates
          let textItems = textContent.items.map(item => {
            return {
              str: item.str,
              y: item.transform[5] // Y coordinate is stored in transform[5]
            };
          });

          // Sort items by Y-coordinate in descending order (header at top, footer at bottom)
          textItems.sort((a, b) => b.y - a.y);

          // Build the ordered text for this page
          let pageText = textItems.map(item => item.str).join(' ');

          // Add the page text to the final extracted text
          extractedText += `Page ${pageNum}:\n${pageText}\n\n`;
        }

        // Display the extracted text on the page
        extractedTextDiv.textContent = extractedText;

      } catch (error) {
        extractedTextDiv.textContent = `Error during PDF text extraction: ${error.message}`;
      }
    }

    // Button event listener to trigger text extraction
    document.getElementById('extractTextBtn').addEventListener('click', () => {
      // Clear previous text
      extractedTextDiv.textContent = '';
      extractTextFromPDF();
    });
  </script>
</body>
</html>
